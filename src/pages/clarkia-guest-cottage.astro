---
import { Image } from 'astro:assets';
import BaseLayout from '../layouts/BaseLayout.astro';
import 'photoswipe/dist/photoswipe.css';
import frontGarden2 from '../assets/front-garden-2.jpg';
import livingRoom1 from '../assets/living-room-1.jpg';
import kitchen1 from '../assets/kitchen-1.jpg';
import fireplace from '../assets/fireplace.jpg';
import mainBedroom1 from '../assets/main-bedroom-1.jpg';
import secondBedroom1 from '../assets/second-bedroom-1.jpg';
import hallway from '../assets/hallway.jpg';
import enSuiteBathroom1 from '../assets/en-suite-bathroom-1.jpg';
import separateBathroom1 from '../assets/separate-bathroom-1.jpg';
import livingRoom3 from '../assets/living-room-3.jpeg';
import livingRoom4 from '../assets/living-room-4.jpeg';
---

<BaseLayout 
  title="Clarkia Cottage | Newlands Cottages Accommodation Details"
  description="View photos, amenities, and details for our private self-catering cottage. Features a full kitchen, private garden, and modern comforts."
>
  <div class="container">
    <h1>Clarkia Cottage</h1>
    
    <!-- Swiper Carousel Gallery -->
    <div>
      <swiper-container navigation="true" pagination="true" space-between="10" slides-per-view="1" class="swiper-main-gallery">
        <swiper-slide>
          <img src={frontGarden2.src} alt="Private garden and outdoor space" class="carousel-image pswp-gallery-item" data-pswp-src={frontGarden2.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={livingRoom1.src} alt="Living room with comfortable seating area" class="carousel-image pswp-gallery-item" data-pswp-src={livingRoom1.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={kitchen1.src} alt="Fully equipped kitchen with modern appliances" class="carousel-image pswp-gallery-item" data-pswp-src={kitchen1.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={fireplace.src} alt="Cozy fireplace in the living area" class="carousel-image pswp-gallery-item" data-pswp-src={fireplace.src} data-pswp-width="800" data-pswp-height="1200" />
        </swiper-slide>
        <swiper-slide>
          <img src={mainBedroom1.src} alt="Main bedroom with king-size bed" class="carousel-image pswp-gallery-item" data-pswp-src={mainBedroom1.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={secondBedroom1.src} alt="Second bedroom with twin beds" class="carousel-image pswp-gallery-item" data-pswp-src={secondBedroom1.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={hallway.src} alt="Welcoming hallway entrance" class="carousel-image pswp-gallery-item" data-pswp-src={hallway.src} data-pswp-width="800" data-pswp-height="1200" />
        </swiper-slide>
        <swiper-slide>
          <img src={enSuiteBathroom1.src} alt="En-suite bathroom with shower and modern fittings" class="carousel-image pswp-gallery-item" data-pswp-src={enSuiteBathroom1.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={separateBathroom1.src} alt="Separate bathroom with shower" class="carousel-image pswp-gallery-item" data-pswp-src={separateBathroom1.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={livingRoom3.src} alt="Back patio with outdoor seating area" class="carousel-image pswp-gallery-item" data-pswp-src={livingRoom3.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
        <swiper-slide>
          <img src={livingRoom4.src} alt="Dining area with table and chairs" class="carousel-image pswp-gallery-item" data-pswp-src={livingRoom4.src} data-pswp-width="1200" data-pswp-height="800" />
        </swiper-slide>
      </swiper-container>
    </div>
    
    <!-- PhotoSwipe root element (required for v5+) -->
    <div id="pswp" class="pswp" tabindex="-1" aria-hidden="true"></div>
    
    <section>
      <h2>About the Space</h2>
      <p>
        Clarkia Cottage provides comfortable 2-bedroom accommodation for up to four guests. The main bedroom features a king-size bed and a full en-suite bathroom, with the second bathroom including two single beds with access to a shower-only bathroom. The kitchen is thoughtfully equipped with essential appliances, including a fridge, a two-ring gas hob, a convection/microwave oven, and an air fryer. For coffee lovers, there's a Nespresso machine, along with a kettle and toaster. A charming combustion wood fireplace adds to the cosy atmosphere, with a smart TV and reliable Wi-Fi available for entertainment. An inverter and battery-operated lights are available if there is loadshedding. Outside, a small front garden offers a pleasant space, while a private patio at the back features a Weber braai for outdoor cooking and a washing machine for laundry needs. Dedicated parking is available on the wide, paved verge in front of the property, suitable for one vehicle.
        <br><br>
        The surrounding area presents a wealth of activities and attractions. Guests can easily access opportunities for hiking, bird watching, wine tasting, cycling, and swimming, ensuring a memorable stay.
      </p>
    </section>
    
    <section class="amenities">
      <h2>Amenities</h2>
      <ul>
        <li>King-size Bed</li>
        <li>High-speed Wi-Fi</li>
        <li>Fully-equipped Kitchenette</li>
        <li>Nespresso Machine</li>
        <li>Private Garden & Patio</li>
        <li>Secure Off-street Parking</li>
        <li>Smart TV with Netflix</li>
        <li>En-suite Bathroom with Shower</li>
      </ul>
    </section>
    
    <section class="booking-section">
      <a href="https://book.nightsbridge.com/12344" target="_blank" class="btn btn-large">
        Check Availability & Book Now
      </a>
    </section>
  </div>

  <!-- Sticky Book Now Banner for Mobile -->
  <div class="sticky-book-banner" id="sticky-banner">
    <div class="banner-content">
      <a href="https://book.nightsbridge.com/12344" target="_blank" class="btn btn-large">
        Check Availability & Book Now
      </a>
      <button class="banner-close" aria-label="Close banner" id="banner-close">âœ•</button>
    </div>
  </div>

  <script type="module">
    import PhotoSwipeLightbox from 'photoswipe/lightbox';
    import 'photoswipe/dist/photoswipe.css';
    import 'swiper/element/bundle';
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize Swiper (Web Component auto-initializes)
      // Initialize PhotoSwipe
      const lightbox = new PhotoSwipeLightbox({
        gallery: '.carousel-container',
        children: '.pswp-gallery-item',
        pswpModule: () => import('photoswipe')
      });
      lightbox.init();
    });
  </script>

  <script>
    // Sticky banner functionality
    document.addEventListener('DOMContentLoaded', function() {
      const stickyBanner = document.getElementById('sticky-banner');
      const bannerClose = document.getElementById('banner-close');
      const bookingSection = document.querySelector('.booking-section');

      if (stickyBanner && bannerClose && bookingSection) {
        // Helper function to check if we're on mobile
        const isMobile = () => window.innerWidth <= 768;

        // Close banner functionality
        bannerClose.addEventListener('click', () => {
          stickyBanner.style.display = 'none';
          // Store preference in localStorage
          localStorage.setItem('banner-closed', 'true');
        });

        // Check if banner was previously closed
        if (localStorage.getItem('banner-closed') === 'true') {
          stickyBanner.style.display = 'none';
        }

        // Intersection Observer to hide banner when booking section is visible
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              stickyBanner.style.display = 'none';
            } else {
              // Only show banner on mobile and if it wasn't manually closed
              if (isMobile() && localStorage.getItem('banner-closed') !== 'true') {
                stickyBanner.style.display = 'block';
              }
            }
          });
        }, {
          threshold: 0.1 // Trigger when 10% of booking section is visible
        });

        observer.observe(bookingSection);

        // Handle window resize to show/hide banner appropriately
        window.addEventListener('resize', () => {
          if (!isMobile()) {
            stickyBanner.style.display = 'none';
          } else if (localStorage.getItem('banner-closed') !== 'true') {
            stickyBanner.style.display = 'block';
          }
        });
      }
    });
  </script>
</BaseLayout> 