---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout 
  title="Clarkia Cottage | Newlands Cottages Accommodation Details"
  description="View photos, amenities, and details for our private self-catering cottage. Features a full kitchen, private garden, and modern comforts."
>
  <div class="container">
    <h1>Clarkia Cottage</h1>
    <div class="gallery" id="gallery">
      <img src="/src/assets/front-garden-2.jpg" alt="Private garden and outdoor space" data-index="0" class="gallery-image" />
      <img src="/src/assets/living-room-1.jpg" alt="Living room with comfortable seating area" data-index="1" class="gallery-image" />
      <img src="/src/assets/kitchen-1.jpg" alt="Fully equipped kitchen with modern appliances" data-index="2" class="gallery-image" />
      <img src="/src/assets/fireplace.jpg" alt="Cozy fireplace in the living area" data-index="3" class="gallery-image" />
      <img src="/src/assets/main-bedroom-1.jpg" alt="Main bedroom with king-size bed" data-index="4" class="gallery-image" />
      <img src="/src/assets/second-bedroom-1.jpg" alt="Second bedroom with twin beds" data-index="5" class="gallery-image" />
      <img src="/src/assets/hallway.jpg" alt="Welcoming hallway entrance" data-index="6" class="gallery-image" />
      <img src="/src/assets/en-suite-bathroom-1.jpg" alt="En-suite bathroom with shower and modern fittings" data-index="7" class="gallery-image" />
      <img src="/src/assets/separate-bathroom-1.jpg" alt="Separate bathroom with shower" data-index="8" class="gallery-image" />
    </div>
    
    <section>
      <h2>About the Space</h2>
      <p>
        Clarkia Cottage provides comfortable 2-bedroom accommodation for up to four guests. The main bedroom features a king-size bed and a full en-suite bathroom, with the second bathroom including two single beds with access to a shower-only bathroom. The kitchen is thoughtfully equipped with essential appliances, including a fridge, a two-ring gas hob, a convection/microwave oven, and an air fryer. For coffee lovers, there's a Nespresso machine, along with a kettle and toaster. A charming combustion wood fireplace adds to the cosy atmosphere, with a smart TV and reliable Wi-Fi available for entertainment. An inverter and battery-operated lights are available if there is loadshedding. Outside, a small front garden offers a pleasant space, while a private patio at the back features a Weber braai for outdoor cooking and a washing machine for laundry needs. Dedicated parking is available on the wide, paved verge in front of the property, suitable for one vehicle.
        <br><br>
        The surrounding area presents a wealth of activities and attractions. Guests can easily access opportunities for hiking, bird watching, wine tasting, cycling, and swimming, ensuring a memorable stay.
      </p>
    </section>
    
    <section class="amenities">
      <h2>Amenities</h2>
      <ul>
        <li>Queen-size Bed</li>
        <li>High-speed Wi-Fi</li>
        <li>Fully-equipped Kitchenette</li>
        <li>Nespresso Machine</li>
        <li>Private Garden & Patio</li>
        <li>Secure Off-street Parking</li>
        <li>Smart TV with Netflix</li>
        <li>En-suite Bathroom with Shower</li>
      </ul>
    </section>
    
    <section class="booking-section">
      <a href="https://book.nightsbridge.com/12344" target="_blank" class="btn btn-large">
        Check Availability & Book Now
      </a>
    </section>
  </div>

  <!-- Image Gallery Modal -->
  <div id="gallery-modal" class="gallery-modal" aria-hidden="true">
    <div class="modal-content">
      <button class="modal-close" aria-label="Close gallery">✕</button>
      <div class="modal-image-container">
        <img id="modal-image" src="" alt="" class="modal-image" />
      </div>
      <div class="modal-navigation">
        <button class="nav-btn prev-btn" aria-label="Previous image">‹</button>
        <button class="nav-btn next-btn" aria-label="Next image">›</button>
      </div>
    </div>
  </div>

  <!-- Sticky Book Now Banner for Mobile -->
  <div class="sticky-book-banner">
    <a href="https://book.nightsbridge.com/12344" target="_blank" class="btn btn-large">
      Check Availability & Book Now
    </a>
  </div>

  <script>
    // Gallery carousel functionality
    document.addEventListener('DOMContentLoaded', function() {
      const gallery = document.getElementById('gallery');
      const modal = document.getElementById('gallery-modal');
      const modalImage = document.getElementById('modal-image');
      const closeBtn = document.querySelector('.modal-close');
      const prevBtn = document.querySelector('.prev-btn');
      const nextBtn = document.querySelector('.next-btn');
      const galleryImages = document.querySelectorAll('.gallery-image');

      if (!gallery || !modal || !modalImage || !closeBtn || !prevBtn || !nextBtn) {
        console.error('Required gallery elements not found');
        return;
      }

      let currentIndex = 0;
      const images = Array.from(galleryImages);

      function openModal(index: number) {
        currentIndex = index;
        const image = images[index] as HTMLImageElement;
        if (modalImage) {
          modalImage.src = image.src;
          modalImage.alt = image.alt;
        }
        if (modal) {
          modal.setAttribute('aria-hidden', 'false');
          modal.classList.add('active');
        }
        document.body.style.overflow = 'hidden';
        
        // Focus management
        if (closeBtn) closeBtn.focus();
      }

      function closeModal() {
        modal.setAttribute('aria-hidden', 'true');
        modal.classList.remove('active');
        document.body.style.overflow = '';
      }

      function showImage(index: number) {
        if (index < 0) index = images.length - 1;
        if (index >= images.length) index = 0;
        
        currentIndex = index;
        const image = images[index] as HTMLImageElement;
        if (modalImage) {
          modalImage.src = image.src;
          modalImage.alt = image.alt;
        }
      }

      function nextImage() {
        showImage(currentIndex + 1);
      }

      function prevImage() {
        showImage(currentIndex - 1);
      }

      // Event listeners
      galleryImages.forEach((image, index) => {
        image.addEventListener('click', () => openModal(index));
        image.addEventListener('keydown', (e) => {
          const keyboardEvent = e as KeyboardEvent;
          if (keyboardEvent.key === 'Enter' || keyboardEvent.key === ' ') {
            e.preventDefault();
            openModal(index);
          }
        });
      });

      closeBtn.addEventListener('click', closeModal);
      prevBtn.addEventListener('click', prevImage);
      nextBtn.addEventListener('click', nextImage);

      // Close modal when clicking outside
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeModal();
        }
      });

      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (!modal.classList.contains('active')) return;
        
        switch (e.key) {
          case 'Escape':
            closeModal();
            break;
          case 'ArrowLeft':
            prevImage();
            break;
          case 'ArrowRight':
            nextImage();
            break;
        }
      });

      // Lazy loading for modal images
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target as HTMLImageElement;
            img.src = img.dataset.src || img.src;
            observer.unobserve(img);
          }
        });
      });

      galleryImages.forEach(img => {
        observer.observe(img);
      });
    });
  </script>
</BaseLayout> 